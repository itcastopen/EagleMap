# 概念

在使用地图服务时，一些概念是需要知道的，比如说：坐标体系、轨迹、终端、轨迹服务等。

# 服务模式

EagleMap提供了两种运行模式，分别是：`BASE`、`COMPLETE`，默认：`BASE`。

> **BASE模式：**
>
> 该模式适合只使用地图的基础功能的业务系统，在该模式下，无需配置MySQL数据库，使用更加的简单。
>
> 基础功能包括：[基础功能](/zh-cn/sdk?id=基础功能) 和 [路线规划](/zh-cn/sdk?id=路线规划) ，不包括轨迹相关的功能。

> **COMPLETE模式：**
>
> 该模式是全功能模式，包括基础功能和轨迹相关的功能，需要配置MySQL数据库。
>
> 如果只设置了该模式，但是并没有配置数据库链接等配置项，启动会报错，无法正常启动EagleMap服务。

# Provider

目前，在EagleMap中，对接了百度地图和高德地图，我们知道不同的地图服务商的接口参数、接口名称都是不一样的，为了统一接口，EagleMap对外只提供了一套restful接口，也就是说，EagleMap在底层做了不同服务商的兼容。

在提供的restful接口中，都会有`provider`参数，通过这个参数用户可以指定使用哪个服务商。前提是你配置了响应的服务商。

对于`provider`参数，EagleMap支持三种模式，分别是`BAIDU`、`AMAP`、`NONE`，默认：`NONE`。**（必须大写）**

- `BAIDU` 模式
  - 用户强制该接口使用百度地图。
- `AMAP` 模式
  - 用户强制该接口使用高德地图。
- `NONE` 模式 *（系统建议设置的模式）*
  - 用户不指定具体的服务商，由EagleMap系统智能选择。
  - 所谓智能选择是指，对于同一个功能，不同的服务商都有实现，哪个实现的好系统就会给他较高的权重，反之权重就低，例如：对于IP定位这个功能而言，高德地图就比百度地图实现的好，因为高德会返回运营商，而百度不会返回。
  - 至于`哪个实现的好`完全是实现者主管的判断。（其实还是相对比较客观的）
  - 如果你不希望EagleMap智能选择，可以在配置文件中通过`default-provider-strategy`参数更改系统的默认策略。

# 轨迹功能

轨迹功能是一套轨迹管理服务，可以满足您追踪车辆等定位设备，可以让开发者迅速构建一套完全属于自己的精准、高效的轨迹管理系统，应用于车队管理、人员管理等领域。

> 百度实现是基于[鹰眼轨迹服务](https://lbsyun.baidu.com/index.php?title=yingyan)，高德实现是基于[猎鹰轨迹服务](https://lbs.amap.com/api/track/summary)，详情可以查看地图服务商的官方文档。

## 名称解释

- **Service**

迹服务。一个service对应一个轨迹管理系统，通过一个service可管理多个终端设备（即terminal），service的唯一标识符是sid。举例说明，针对某网约车公司的轨迹管理系统，可以创建一个service，在创建的service中管理所有营运车辆的轨迹。

- **Terminal**

一个terminal代表现实中一个终端设备，它可以是个体、也可以是一辆车或者任何运动的物体。在同一个service中，terminal以tid作为唯一标识。

- **Terminal column**

terminal的自定义属性字段，由开发者管理，用以描述终端设备，对于车辆可以是车牌号、载重等。

- **Trace**

terminal移动所产生的点数据组成的连续轨迹被称为trace，trace由一系列点（point）组成。

- **trname**

trname即轨迹名称，支持开发者自主添加命名，以方便开发者在轨迹查询、分析时更具有辨识度。

- **Trace column**

除坐标、速度、方向、定位时间等轨迹点的系统字段外，支持开发者针对轨迹点添加自定义字段。如设备采点时的所在高度（海拔）、冷链运输过程中的车厢内温度。

## 服务结构

<img src="/_media/structure.png" style="zoom: 80%;" />

不同的地图服务商的限额是不一样的，具体是：

> **百度地图：**
>
> 一个开发者最多可创建10个service，一个service至多同时管理100万个entity，轨迹点数量无限制。

> **高德地图：**
>
> 一个高德 Key 下最多可创建15个 Service 。对 Service 的增删改查需要通过 API 接口完成。一个 Service 最多创建10万个 terminal 。 单个 terminal 下轨迹点数量没有限制，限定了可创建的trace条数为50万条。

!> 需要注意的是，百度地图没有`轨迹`概念，它只是某个（entity）在某个时间段内的轨迹点（所以是个虚拟的概念），EagleMap为了统一地图服务商，同样为百度地图提供了`轨迹`这个概念，也就是说，在EagleMap时可以忽略百度地图的这个设计。**EagleMap采用了和高德地图一样的设计，所以建议使用高德地图作为轨迹的服务商。**